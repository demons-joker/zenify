## 📱 Zenify 注册流程 - 手动测试指南

### 🚀 启动应用

应用已在 Windows 平台启动。如果需要重新启动：

```bash
cd d:\workspace\flutterApp\zenify
flutter run -d windows
```

DevTools 可访问: http://127.0.0.1:9101?uri=http://127.0.0.1:53164/

---

## 📋 测试流程

### **Step 1: 基础信息页面 (BasicInfoPage)**

#### 🎯 目标

验证用户能够输入基本信息并正确存储。

#### 📝 测试步骤

1. **进入应用**

   - 预期: 看到 "Step 1 of 4" 标题
   - 看到三个输入字段: 姓名、性别、出生日期

2. **输入姓名**

   - 点击 "姓名" 文本框
   - 输入: `张三`
   - 验证: 文本正确显示

3. **选择性别**

   - 点击性别下拉菜单 (显示 "请选择性别")
   - 选择: `男` (或 `女`)
   - 验证: 下拉菜单更新为选中值

4. **选择出生日期**

   - 点击 "出生日期" 字段
   - 选择日期: `1990-05-15`
   - 验证: 日期字段显示选中日期

5. **点击下一步按钮**
   - 预期: 所有字段都有值时，"下一步" 按钮应启用
   - 点击 "下一步"
   - 验证: 进入 Step 2 (SmartQuestionnairePage)

#### ✅ 预期结果

- 基本信息存储在 Provider 中
- 顺利过渡到 Step 2
- 可以点击 "上一步" 返回修改信息

#### 🧪 测试数据集合

| 用例     | 姓名 | 性别 | 出生日期   | 预期分类 |
| -------- | ---- | ---- | ---------- | -------- |
| 儿童     | 小红 | 女   | 2017-03-20 | 儿童     |
| 青少年   | 张三 | 男   | 2008-06-15 | 青少年   |
| 成年男性 | 李四 | 男   | 1995-02-10 | 成年男性 |
| 成年女性 | 王五 | 女   | 1993-07-25 | 成年女性 |
| 中年     | 赵六 | 女   | 1970-11-30 | 中年     |
| 老年     | 孙七 | 男   | 1950-04-05 | 老年     |

---

### **Step 2: 动态问卷页面 (SmartQuestionnairePage)**

#### 🎯 目标

验证问卷根据年龄/性别动态适配，问卷数据正确存储。

#### 📝 测试步骤 (以 30 岁女性为例)

1. **验证页面标题**

   - 预期: "Step 2 of 4"
   - 顶部显示用户信息: "张三 (女, 30 岁) - 成年女性"

2. **填写问卷**

   **问题 1: 工作压力**

   - 看到选项: "无压力" / "轻度" / "中度" / "高度"
   - 选择: "中度"

   **问题 2: 运动频率**

   - 看到滑块 (0-7 次/周)
   - 调整到: 3 (每周 3 次)

   **问题 3: 月经周期**

   - 看到输入框
   - 输入: 28 (天)

   **问题 4: 体检频率**

   - 看到按钮组: "每年一次" / "两年一次" / "从不"
   - 选择: "每年一次"

   **问题 5: 运动类型**

   - 看到多选复选框: "有氧" / "力量" / "柔韧"
   - 选择: "有氧", "柔韧"

3. **数据保存验证**

   - 填写过程中，所有答案应自动保存到 Provider
   - 返回上一步再进入，答案应被保留

4. **点击下一步**
   - 验证: 所有问题都有答案时才启用 "下一步"
   - 点击进入 Step 3

#### ✅ 预期问卷类型

根据年龄和性别，应显示不同的问卷版本:

| 用户画像     | 问卷类型     | 问题示例                                             |
| ------------ | ------------ | ---------------------------------------------------- |
| ≤12 岁       | 儿童问卷     | 学校表现、饮食习惯、运动频率、睡眠质量、视力         |
| 13-18 岁     | 青少年问卷   | 职业兴趣、课外活动、睡眠质量、设备使用时间、运动能力 |
| 19-45 岁, 男 | 成年男性问卷 | 工作压力、健身计划、心脏健康、营养、压力缓解         |
| 19-45 岁, 女 | 成年女性问卷 | 工作压力、健身、月经周期、体检频率、铁质补充         |
| 46-65 岁     | 中年问卷     | 慢病、体重、运动、睡眠、心理健康                     |
| >65 岁       | 老年问卷     | 慢病、用药、活动能力、认知功能、社交生活             |

#### 🧪 测试用例

- 填写不完整问卷，验证"下一步"按钮是否禁用
- 修改答案后返回，验证数据是否保留
- 对不同年龄段用户测试，验证问卷是否正确切换

---

### **Step 3: 健康目标选择页面 (GoalsPage)**

#### 🎯 目标

验证 AI 推荐目标正确、用户可以选择目标、目标数据正确存储。

#### 📝 测试步骤

1. **进入 GoalsPage**

   - 预期: "Step 3 of 4"
   - 显示推荐目标列表
   - 预选了最多 5 个目标

2. **查看目标推荐**

   - 看到目标卡片，包含:
     - 目标名称
     - 描述文本
     - 优先级徽章 (高/中/低，不同颜色)
     - 复选框

3. **验证推荐逻辑**

   **基础测试 (30 岁女性, 中度压力, 每周 3 次运动)**

   - 预期推荐包含: 激素平衡、健身计划、工作平衡等

   **压力测试 (45 岁女性, 高压力, 很少运动)**

   - 预期推荐包含: 紧急压力管理、增加运动、工作平衡

   **高龄测试 (70 岁男性)**

   - 预期推荐包含: 慢病控制、骨密度、跌倒预防、认知功能

4. **修改目标选择**

   - 点击目标卡片或复选框，切换选中状态
   - 验证: 选中目标的复选框状态变化
   - 底部显示: "已选择 X 个目标"

5. **使用分类过滤 (如果实现)**

   - 点击分类按钮: "营养", "运动", "健康"
   - 验证: 列表过滤并自动选中匹配目标
   - 点击 "全选" / "清除所有" 按钮测试

6. **点击下一步**
   - 验证: 至少选中 1 个目标时启用
   - 进入 Step 4

#### ✅ 预期行为

- 推荐目标数 ≤ 5 个
- 优先级正确显示 (高=红, 中=橙, 低=绿)
- 选择状态正确保存
- 可以修改选择后重新点击下一步

#### 🧪 测试场景

- 不选择任何目标，验证"下一步"是否禁用
- 选择 1 个目标，点击下一步
- 选择 5 个目标，验证是否全部保存
- 返回修改，验证选择是否保留

---

### **Step 4: 高级信息页面 (AdvancedInfoPage)**

#### 🎯 目标

验证可选高级信息的收集、文件上传、数据存储和跳过功能。

#### 📝 测试步骤

**Section 1: 慢病选择**

1. 看到 FilterChip 列表:

   - 高血压, 糖尿病, 高血脂, 心脏病, 肺部疾病, 骨质疏松, 甲状腺, 肝脏, 肾脏, 其他

2. 选择多个慢病:

   - 点击 "高血压"
   - 点击 "糖尿病"
   - 验证: 选中的 chip 变为蓝色
   - 下方显示选中的疾病列表

3. 取消选择:
   - 再次点击 "高血压"
   - 验证: chip 变回灰色，列表更新

**Section 2: 食物过敏**

1. 看到标签输入组件
2. 输入过敏食物:
   - 在文本框输入: "花生"
   - 点击 "添加" 或按 Enter
   - 验证: 标签显示为 Chip
3. 输入更多:
   - 添加: "海鲜", "牛奶", "鸡蛋"
4. 删除标签:
   - 点击标签右侧的 ✕ 按钮
   - 验证: 标签被移除
5. 防重复测试:
   - 输入已存在的标签
   - 验证: 显示重复警告或忽略

**Section 3: 当前用药**

1. 看到多行文本输入框
2. 输入用药信息:
   ```
   阿司匹林 - 每天一次, 100mg
   二甲双胍 - 每天两次, 500mg
   ```
3. 验证: 文本正确保存

**Section 4: 健康报告上传**

1. 看到 "拍照" 和 "相册" 按钮
2. 测试拍照:
   - 点击 "拍照" 按钮
   - 相机打开，拍摄照片 (或取消)
   - 验证: 文件出现在列表中
3. 测试相册:
   - 点击 "相册" 按钮
   - 选择一张或多张图片 (最多 5 张)
   - 验证: 文件列表更新，显示文件名和大小
4. 查看上传进度:
   - 进度条显示上传进度 (0% → 100%)
5. 删除文件:
   - 点击文件右侧的删除按钮
   - 验证: 文件从列表移除

#### 可选步骤测试

1. **完全跳过 Step 4**:

   - 点击顶部 "跳过" 按钮
   - 验证: 直接进入 Step 5 (或完成页面)
   - 验证: AdvancedInfo 不包含任何数据

2. **部分填写**:

   - 选择 1 个慢病
   - 添加 2 个过敏
   - 不上传文件
   - 点击 "下一步"
   - 验证: 只有选定的数据被保存

3. **全部填写**:
   - 完成所有 4 个 section
   - 点击 "下一步"
   - 验证: 所有数据正确保存

#### ✅ 预期行为

- Step 4 标记为 "可选"
- 可以跳过或部分填写
- 文件上传应显示进度
- 数据实时同步到 Provider

#### 🧪 测试场景

- 完全跳过: 不填任何信息
- 部分填写: 只填慢病
- 全部填写: 所有 section 都填
- 再次返回: 验证数据是否保留
- 修改信息: 更改慢病选择, 验证更新

---

### **完整流程测试**

#### 🎯 目标

验证整个 4 步注册流程的端到端工作。

#### 📝 完整测试场景

**用户画像: 35 岁上班族女性**

```
Step 1:
  姓名: 李女士
  性别: 女
  出生日期: 1989-12-20

Step 2 (自动进入成年女性问卷):
  工作压力: 高
  运动频率: 2 次/周
  月经周期: 28 天
  体检频率: 两年一次
  运动类型: 瑜伽, 散步

Step 3 (AI 推荐目标):
  自动推荐 5 个目标
  用户可调整选择
  最终选择: 4 个目标

Step 4 (可选高级信息):
  慢病: 无
  过敏: 对坚果过敏
  用药: 偶尔感冒时吃阿司匹林
  报告: 上传 2 张最近体检报告
```

#### 验证清单

- [ ] Step 1 信息正确显示
- [ ] Step 2 显示女性问卷
- [ ] Step 2 答案保存，返回不丢失
- [ ] Step 3 推荐合理 (包含女性特定目标)
- [ ] Step 3 选择可修改
- [ ] Step 4 可跳过或填写
- [ ] Step 4 数据保存
- [ ] 所有步骤可返回修改
- [ ] 完成后进入 Step 5 (或总结页面)

---

## 🔍 关键验证点

### 数据持久化

- [ ] 返回 Step 1 修改名字后，重新进入 Step 2，前面的答案应保留
- [ ] 在 Step 3 修改目标后，返回 Step 2，答案仍在
- [ ] 在 Step 4 填写信息后，返回 Step 3，目标选择不变

### 状态一致性

- [ ] 页面标题始终显示 "Step X of 4"
- [ ] "下一步" 按钮的启用/禁用状态正确
- [ ] "上一步" 按钮在 Step 1 应禁用
- [ ] "跳过" 按钮仅在 Step 4 显示

### 用户体验

- [ ] 所有页面加载速度快 (< 500ms)
- [ ] 没有明显卡顿或错误日志
- [ ] 文本输入响应灵敏
- [ ] 文件上传显示进度
- [ ] 返回时页面加载快速 (使用缓存)

---

## 📊 测试报告模板

### 测试编号: TEST-001

**日期**: \_**\_-\_\_**-\_**\_  
**测试人员**: **\_\_\_\_****  
**用户场景**: Step 1 基础信息

| 步骤       | 预期结果    | 实际结果 | 通过 |
| ---------- | ----------- | -------- | ---- |
| 输入姓名   | 文本显示    | **\_\_** | ☐    |
| 选择性别   | 下拉更新    | **\_\_** | ☐    |
| 选择日期   | 日期显示    | **\_\_** | ☐    |
| 点击下一步 | 进入 Step 2 | **\_\_** | ☐    |

**备注**: ************\_\_************

---

## 🐛 问题报告

如遇问题，请记录:

1. **问题描述**:
2. **重现步骤**:
3. **预期结果**:
4. **实际结果**:
5. **截图/日志**:
6. **严重级别**: ☐ 关键 ☐ 高 ☐ 中 ☐ 低

---

## 📚 相关文档

- [单元测试报告](./REGISTRATION_FLOW_TEST_REPORT.md)
- [技术设计文档](../presentation/registration/GOALS_PAGE_DOCUMENTATION.md)
- [代码架构说明](../models/README.md)

---

**最后更新**: 2025-12-11  
**版本**: 1.0  
✅ 完整的手动测试指南
